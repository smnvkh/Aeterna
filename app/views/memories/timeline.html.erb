<section class="ShiftLeft">
  <h1>Лента времени</h1>

  <div>
    <%= link_to "All memories", memories_path %>
    
    <% Memory.tag_counts_on(:categories).each do |tag| %>
      <%= link_to tag.name, by_tag_memories_path(tag.name) %>
    <% end %>
  </div>

  <hr>
  
  <%= link_to 'Создать воспоминание', new_memory_path %>
  
  <div class="timeline">
    <% @memories_by_year.each do |year, memories| %>
      <div class="timeline-year">
        <h2><%= year %></h2>
  
        <% memories.each do |memory| %>
          <div class="timeline-item">
            <h3>
              <% if memory.family_member.user&.profile %>
                <%= link_to \
                  "#{memory.family_member.to_s}",
                  profile_path(memory.family_member.user.profile)
                %>
              <% else %>
                <%= memory.family_member.name %>
              <% end %>
            </h3>
  
            <div class="memory-image">
              <%= link_to memory do %>
                <%= image_tag memory.image.q70.url, width: 300 %>
              <% end %>
            </div>
  
            <p><%= l(memory.date, format: :long) %></p>
            <p><%= memory.body %></p>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</section>
